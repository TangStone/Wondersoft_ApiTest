{"uid":"f9355e6e95306c07","name":"新增用户组-长度校验","fullName":"bms.testcases.test_04_user.TestUser#test_user_group_add","historyId":"01e42f2b4ca4d0e6175537a726fe6570","time":{"start":1687942581044,"stop":1687942581140,"duration":96},"description":"新增用户组，用户组名称超长，新增失败，提示信息正确","descriptionHtml":"<p>新增用户组，用户组名称超长，新增失败，提示信息正确</p>\n","status":"failed","statusMessage":"AssertionError","statusTrace":"self = <bms.testcases.test_04_user.TestUser object at 0x00000233A91B4550>, caseid = 'user_group_add_04'\ncasedata = {'base_url': '${config(host)}', 'caseid': 'user_group_add_04', 'description': '新增用户组，用户组名称超长，新增失败，提示信息正确', 'epic': '用户管理', ...}\n\n    @pytest.mark.parametrize('caseid, casedata', [(caseid, casedata) for caseid, casedata in\n                                                  readcase.ReadCase().get_case_dict(\n                                                      ROOT_DIR + 'bms/data/user/user_group_add.yaml').items()])\n    def test_user_group_add(self, caseid, casedata):\n        handleallure.allure_display(casedata)\n        logging.info(\"==========开始执行用例：%s==========\", caseid)\n>       runcase.excute_case(casedata)\n\nbms\\testcases\\test_04_user.py:38: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\ncommon\\runcase.py:55: in excute_case\n    checkresult.check_result(hope_result, recv_data, recv_code)\ncommon\\checkresult.py:33: in check_result\n    assert_db(value)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nhope_res = [{'result': [{'path': '$.count', 'value': 0}], 'sql': \"select count(*) as count from `bms-general-uba`.t_group_info where groupName = '自动化测试根组自动化测试根组自动化测试根组自动化测试根组自动化测试根组自动化测试根组自动化测试根组自动化测试根组' and isRemoved = '0'\", 'type': 'mysql'}]\n\n    def assert_db(hope_res):\n        \"\"\"\n        数据库校验\n        :param hope_res:\n        :return:\n        \"\"\"\n        if hope_res:\n            for dbcheck_data in hope_res:\n                db_type = dbcheck_data['type']  # 数据库类型\n                db_sql = dbcheck_data['sql']\n                if db_type == 'mysql':\n                    if db_sql[0:6].upper() == 'SELECT':\n                        sql_date = database.MysqlConn().mysql_query(db_sql)\n                        with allure.step(\"数据库校验校验\"):\n                            for param in dbcheck_data['result']:\n                                sql_value = jsonpath.jsonpath(sql_date, param['path'])\n                                value = param['value']\n                                try:\n                                    allure.attach(name=\"查询sql\", body=str(db_sql))\n                                    allure.attach(name=\"期望返回值\", body=str(value))\n                                    if sql_value:\n                                        allure.attach(name='实际返回值', body=str(sql_value[0]))\n>                                       assert str(value) == str(sql_value[0])\nE                                       AssertionError\n\ncommon\\checkresult.py:57: AssertionError","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":3,"retriesStatusChange":false,"beforeStages":[],"testStage":{"description":"新增用户组，用户组名称超长，新增失败，提示信息正确","status":"failed","statusMessage":"AssertionError","statusTrace":"self = <bms.testcases.test_04_user.TestUser object at 0x00000233A91B4550>, caseid = 'user_group_add_04'\ncasedata = {'base_url': '${config(host)}', 'caseid': 'user_group_add_04', 'description': '新增用户组，用户组名称超长，新增失败，提示信息正确', 'epic': '用户管理', ...}\n\n    @pytest.mark.parametrize('caseid, casedata', [(caseid, casedata) for caseid, casedata in\n                                                  readcase.ReadCase().get_case_dict(\n                                                      ROOT_DIR + 'bms/data/user/user_group_add.yaml').items()])\n    def test_user_group_add(self, caseid, casedata):\n        handleallure.allure_display(casedata)\n        logging.info(\"==========开始执行用例：%s==========\", caseid)\n>       runcase.excute_case(casedata)\n\nbms\\testcases\\test_04_user.py:38: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\ncommon\\runcase.py:55: in excute_case\n    checkresult.check_result(hope_result, recv_data, recv_code)\ncommon\\checkresult.py:33: in check_result\n    assert_db(value)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nhope_res = [{'result': [{'path': '$.count', 'value': 0}], 'sql': \"select count(*) as count from `bms-general-uba`.t_group_info where groupName = '自动化测试根组自动化测试根组自动化测试根组自动化测试根组自动化测试根组自动化测试根组自动化测试根组自动化测试根组' and isRemoved = '0'\", 'type': 'mysql'}]\n\n    def assert_db(hope_res):\n        \"\"\"\n        数据库校验\n        :param hope_res:\n        :return:\n        \"\"\"\n        if hope_res:\n            for dbcheck_data in hope_res:\n                db_type = dbcheck_data['type']  # 数据库类型\n                db_sql = dbcheck_data['sql']\n                if db_type == 'mysql':\n                    if db_sql[0:6].upper() == 'SELECT':\n                        sql_date = database.MysqlConn().mysql_query(db_sql)\n                        with allure.step(\"数据库校验校验\"):\n                            for param in dbcheck_data['result']:\n                                sql_value = jsonpath.jsonpath(sql_date, param['path'])\n                                value = param['value']\n                                try:\n                                    allure.attach(name=\"查询sql\", body=str(db_sql))\n                                    allure.attach(name=\"期望返回值\", body=str(value))\n                                    if sql_value:\n                                        allure.attach(name='实际返回值', body=str(sql_value[0]))\n>                                       assert str(value) == str(sql_value[0])\nE                                       AssertionError\n\ncommon\\checkresult.py:57: AssertionError","steps":[{"name":"执行当前接口：新增用户组-长度校验","time":{"start":1687942581048,"stop":1687942581129,"duration":81},"status":"passed","steps":[],"attachments":[{"uid":"a8711a47b56af755","name":"请求方法：","source":"a8711a47b56af755.attach","type":"text/plain","size":4},{"uid":"1d6d446c28ed9f28","name":"请求地址","source":"1d6d446c28ed9f28.attach","type":"text/plain","size":47},{"uid":"f5cc4b0b5b1c35dd","name":"请求头","source":"f5cc4b0b5b1c35dd.attach","type":"text/plain","size":464},{"uid":"fad291e17364a122","name":"请求参数","source":"fad291e17364a122.attach","type":"text/plain","size":207},{"uid":"ff2c3c035fe541e5","name":"请求结果","source":"ff2c3c035fe541e5.attach","type":"text/plain","size":230}],"parameters":[],"stepsCount":0,"hasContent":true,"attachmentsCount":5,"shouldDisplayMessage":false},{"name":"结果校验","time":{"start":1687942581129,"stop":1687942581139,"duration":10},"status":"failed","statusMessage":"AssertionError\n","statusTrace":"  File \"E:\\Wondersoft_ApiTest\\common\\checkresult.py\", line 33, in check_result\n    assert_db(value)\n  File \"E:\\Wondersoft_ApiTest\\common\\checkresult.py\", line 57, in assert_db\n    assert str(value) == str(sql_value[0])\n","steps":[{"name":"状态码校验","time":{"start":1687942581129,"stop":1687942581132,"duration":3},"status":"passed","steps":[],"attachments":[{"uid":"685b5b1a7e3ef6fa","name":"期望状态码","source":"685b5b1a7e3ef6fa.attach","type":"text/plain","size":3},{"uid":"26190d03012e8016","name":"实际状态码","source":"26190d03012e8016.attach","type":"text/plain","size":3}],"parameters":[],"stepsCount":0,"hasContent":true,"attachmentsCount":2,"shouldDisplayMessage":false},{"name":"数据库校验校验","time":{"start":1687942581136,"stop":1687942581139,"duration":3},"status":"failed","statusMessage":"AssertionError\n","statusTrace":"  File \"E:\\Wondersoft_ApiTest\\common\\checkresult.py\", line 57, in assert_db\n    assert str(value) == str(sql_value[0])\n","steps":[],"attachments":[{"uid":"ba60de6d10d1803","name":"查询sql","source":"ba60de6d10d1803.attach","type":"text/plain","size":269},{"uid":"f180d967eab219b0","name":"期望返回值","source":"f180d967eab219b0.attach","type":"text/plain","size":1},{"uid":"c2f4dd3bfe788691","name":"实际返回值","source":"c2f4dd3bfe788691.attach","type":"text/plain","size":1}],"parameters":[],"stepsCount":0,"hasContent":true,"attachmentsCount":3,"shouldDisplayMessage":true}],"attachments":[],"parameters":[],"stepsCount":2,"hasContent":true,"attachmentsCount":5,"shouldDisplayMessage":false}],"attachments":[{"uid":"5685fb42dc876d8b","name":"log","source":"5685fb42dc876d8b.txt","type":"text/plain","size":13919}],"parameters":[],"stepsCount":4,"hasContent":true,"attachmentsCount":11,"shouldDisplayMessage":true},"afterStages":[],"labels":[{"name":"epic","value":"用户管理"},{"name":"feature","value":"基础数据管理-用户与机构管理"},{"name":"story","value":"新增用户组接口"},{"name":"parentSuite","value":"bms.testcases"},{"name":"suite","value":"test_04_user"},{"name":"subSuite","value":"TestUser"},{"name":"host","value":"OFYI7JX9DURTDV6"},{"name":"thread","value":"14556-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"bms.testcases.test_04_user"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[{"uid":"e31f13defc8d3016","status":"failed","statusDetails":"AssertionError","time":{"start":1687942575911,"stop":1687942576012,"duration":101}},{"uid":"7abb44678fc0f7d2","status":"failed","statusDetails":"AssertionError","time":{"start":1687942570787,"stop":1687942570883,"duration":96}},{"uid":"64f2482aefecc4ce","status":"failed","statusDetails":"AssertionError","time":{"start":1687942565639,"stop":1687942565760,"duration":121}}],"categories":[{"name":"Product defects","matchedStatuses":[],"flaky":false}],"tags":[]},"source":"f9355e6e95306c07.json","parameterValues":[]}