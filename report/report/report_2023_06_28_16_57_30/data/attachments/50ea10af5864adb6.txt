[32mINFO    [0m root:test_08_docrule.py:37 ==========开始执行用例：docrule_list_03==========
[32mINFO    [0m root:runcase.py:31 -·-·-·-·-·-·-·-·-·-发送请求并接受信息 START-·-·-·-·-·-·-·-·-·-
[32mINFO    [0m root:handleyaml.py:94 Yaml测试用例基础架构检查通过
[32mINFO    [0m root:runcase.py:50 重组后的用例信息：{'name': '文档规则列表查询-根据规则类型查询', 'description': '输入规则类型搜索条件，查看文档规则列表', 'request': {'data': {'dlpType': '2', 'page': 1, 'rows': 20}, 'method': 'POST', 'address': '/api/dlpparam/v1/dlpDocRule/selectDlpDocRules', 'headers': {'Content-Type': 'application/x-www-form-urlencoded', 'token': 'eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzUxMiJ9.eyJhdWQiOiJhcHBsaWNhdGlvbiIsInN1YiI6Ijc2ZDQ0NmFlLTdkMGEtNDVhYy04NzE0LTgxNmQzMzRjYzg4ZSIsImlzcyI6ImJtc19zZXJ2ZXIiLCJzZXNzaW9uSWQiOiI3NmQ0NDZhZS03ZDBhLTQ1YWMtODcxNC04MTZkMzM0Y2M4OGUiLCJleHAiOjE2ODgxMjIyMDEsImlhdCI6MTY4Nzk0MjIwMX0.FWYPT5nPgOdBtOT0wGRVZNVTB6oggV1ehXLgP2gppALL2Djxp_46T_KhaOizqJlxUPAYRWJs7nKHiU-ug2qGKA', 'Referer': 'https://192.168.148.174:31000/sub-app-dlpparam/dlpFileDocRule'}}, 'validate': {'code': 200, 'response': {'statusCode': 0}, 'jsonpath': [{'path': '$.data.resultList[0].c_rule_name', 'value': '自动化测试', 'type': 'in'}]}, 'epic': '规则管理', 'feature': '基础规则-关键字/正则', 'story': '文档规则列表查询接口', 'base_url': 'https://192.168.148.174:31000', 'caseid': 'docrule_list_03'}
[32mINFO    [0m root:runcase.py:81 请求地址：https://192.168.148.174:31000/api/dlpparam/v1/dlpDocRule/selectDlpDocRules
[32mINFO    [0m root:runcase.py:82 请求方法：POST
[32mINFO    [0m root:runcase.py:83 请求头：{'Content-Type': 'application/x-www-form-urlencoded', 'token': 'eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzUxMiJ9.eyJhdWQiOiJhcHBsaWNhdGlvbiIsInN1YiI6Ijc2ZDQ0NmFlLTdkMGEtNDVhYy04NzE0LTgxNmQzMzRjYzg4ZSIsImlzcyI6ImJtc19zZXJ2ZXIiLCJzZXNzaW9uSWQiOiI3NmQ0NDZhZS03ZDBhLTQ1YWMtODcxNC04MTZkMzM0Y2M4OGUiLCJleHAiOjE2ODgxMjIyMDEsImlhdCI6MTY4Nzk0MjIwMX0.FWYPT5nPgOdBtOT0wGRVZNVTB6oggV1ehXLgP2gppALL2Djxp_46T_KhaOizqJlxUPAYRWJs7nKHiU-ug2qGKA', 'Referer': 'https://192.168.148.174:31000/sub-app-dlpparam/dlpFileDocRule'}
[32mINFO    [0m root:runcase.py:93 请求参数：{'dlpType': '2', 'page': 1, 'rows': 20}
[35mDEBUG   [0m urllib3.connectionpool:connectionpool.py:1003 Starting new HTTPS connection (1): 192.168.148.174:31000
[35mDEBUG   [0m urllib3.connectionpool:connectionpool.py:456 https://192.168.148.174:31000 "POST /api/dlpparam/v1/dlpDocRule/selectDlpDocRules HTTP/1.1" 200 16017
[32mINFO    [0m root:runcase.py:155 请求接口结果： {'statusCode': 0, 'data': {'resultList': [{'c_id': '8c571c8885074c88a44e58075539ec53', 'c_rule_name': '自动化测试正则规则', 'c_rule_type': 2, 'c_rule_content': '(?<!(手|工))测试', 'c_create_time': '2023-06-28 16:54:04', 'c_creater': 'admin', 'c_update_time': '2023-06-28 16:54:04', 'c_updater': 'admin', 'c_note': '不匹配自动化测试文本', 'c_is_remove': 0, 'c_rule_class': 2, 'c_use_status': 1, 'dlpStrategyList': [], 'c_traditional_match': 0}, {'c_id': 'default_rule_34', 'c_rule_name': '中国公务护照', 'c_rule_type': 2, 'c_rule_introduction': '中国公务护照正则表达式', 'c_rule_content': '中国公务护照正则表达式', 'c_version': 1, 'c_sync_flag': 0, 'c_from_type': 2, 'c_create_time': '2022-07-28 14:14:10', 'c_creater': 'admin', 'c_update_time': '2022-07-28 14:14:10', 'c_updater': 'admin', 'c_is_remove': 0, 'c_rule_class': 1, 'c_use_status': 1, 'dlpStrategyList': []}, {'c_id': 'default_rule_33', 'c_rule_name': '澳门特别行政区护照', 'c_rule_type': 2, 'c_rule_introduction': '澳门特别行政区护照正则表达式', 'c_rule_content': '澳门特别行政区护照正则表达式', 'c_version': 1, 'c_sync_flag': 0, 'c_from_type': 2, 'c_create_time': '2022-07-28 14:14:10', 'c_creater': 'admin', 'c_update_time': '2022-07-28 14:14:10', 'c_updater': 'admin', 'c_is_remove': 0, 'c_rule_class': 1, 'c_use_status': 1, 'dlpStrategyList': []}, {'c_id': 'default_rule_32', 'c_rule_name': '发动机号', 'c_rule_type': 2, 'c_rule_introduction': '发动机号正则表达式', 'c_rule_content': '发动机号正则表达式', 'c_version': 1, 'c_sync_flag': 0, 'c_from_type': 2, 'c_create_time': '2022-07-28 14:14:10', 'c_creater': 'admin', 'c_update_time': '2022-07-28 14:14:10', 'c_updater': 'admin', 'c_is_remove': 0, 'c_rule_class': 1, 'c_use_status': 1, 'dlpStrategyList': []}, {'c_id': 'default_rule_31', 'c_rule_name': '个人信用报告编号', 'c_rule_type': 2, 'c_rule_introduction': '个人信用报告编号正则表达式', 'c_rule_content': '个人信用报告编号正则表达式', 'c_version': 1, 'c_sync_flag': 0, 'c_from_type': 2, 'c_create_time': '2022-07-28 14:14:10', 'c_creater': 'admin', 'c_update_time': '2022-07-28 14:14:10', 'c_updater': 'admin', 'c_is_remove': 0, 'c_rule_class': 1, 'c_use_status': 1, 'dlpStrategyList': []}, {'c_id': 'default_rule_30', 'c_rule_name': '中国外交护照', 'c_rule_type': 2, 'c_rule_introduction': '中国外交护照正则表达式', 'c_rule_content': '中国外交护照正则表达式', 'c_version': 1, 'c_sync_flag': 0, 'c_from_type': 2, 'c_create_time': '2022-07-28 14:14:10', 'c_creater': 'admin', 'c_update_time': '2022-07-28 14:14:10', 'c_updater': 'admin', 'c_is_remove': 0, 'c_rule_class': 1, 'c_use_status': 1, 'dlpStrategyList': []}, {'c_id': 'default_rule_29', 'c_rule_name': '车架号', 'c_rule_type': 2, 'c_rule_introduction': '车架号正则表达式', 'c_rule_content': '车架号正则表达式', 'c_version': 1, 'c_sync_flag': 0, 'c_from_type': 2, 'c_create_time': '2022-07-28 14:14:10', 'c_creater': 'admin', 'c_update_time': '2022-07-28 14:14:10', 'c_updater': 'admin', 'c_is_remove': 0, 'c_rule_class': 1, 'c_use_status': 1, 'dlpStrategyList': []}, {'c_id': 'default_rule_28', 'c_rule_name': '车牌号', 'c_rule_type': 2, 'c_rule_introduction': '车牌号正则表达式', 'c_rule_content': '车牌号正则表达式', 'c_version': 1, 'c_sync_flag': 0, 'c_from_type': 2, 'c_create_time': '2022-07-28 14:14:10', 'c_creater': 'admin', 'c_update_time': '2022-07-28 14:14:10', 'c_updater': 'admin', 'c_is_remove': 0, 'c_rule_class': 1, 'c_use_status': 1, 'dlpStrategyList': []}, {'c_id': 'default_rule_27', 'c_rule_name': '军官证号', 'c_rule_type': 2, 'c_rule_introduction': '军官证号正则表达式', 'c_rule_content': '军官证号正则表达式', 'c_version': 1, 'c_sync_flag': 0, 'c_from_type': 2, 'c_create_time': '2022-07-28 14:14:10', 'c_creater': 'admin', 'c_update_time': '2022-07-28 14:14:10', 'c_updater': 'admin', 'c_is_remove': 0, 'c_rule_class': 1, 'c_use_status': 1, 'dlpStrategyList': []}, {'c_id': 'default_rule_26', 'c_rule_name': '香港特别行政区护照', 'c_rule_type': 2, 'c_rule_introduction': '香港特别行政区护照正则表达式', 'c_rule_content': '香港特别行政区护照正则表达式', 'c_version': 1, 'c_sync_flag': 0, 'c_from_type': 2, 'c_create_time': '2022-07-28 14:14:10', 'c_creater': 'admin', 'c_update_time': '2022-07-28 14:14:10', 'c_updater': 'admin', 'c_is_remove': 0, 'c_rule_class': 1, 'c_use_status': 1, 'dlpStrategyList': []}, {'c_id': 'default_rule_25', 'c_rule_name': '中国普通护照', 'c_rule_type': 2, 'c_rule_introduction': '中国普通护照正则表达式', 'c_rule_content': '中国普通护照正则表达式', 'c_version': 1, 'c_sync_flag': 0, 'c_from_type': 2, 'c_create_time': '2022-07-28 14:14:10', 'c_creater': 'admin', 'c_update_time': '2022-07-28 14:14:10', 'c_updater': 'admin', 'c_is_remove': 0, 'c_rule_class': 1, 'c_use_status': 1, 'dlpStrategyList': []}, {'c_id': 'data_feature_rule_9', 'c_rule_name': '燃气用户编号11位数据内容匹配', 'c_rule_type': 2, 'c_rule_introduction': '燃气用户编号11位数据内容正则表达式', 'c_rule_content': '燃气用户编号11位数据内容正则表达式', 'c_create_time': '2022-06-22 14:45:00', 'c_creater': 'admin', 'c_update_time': '2022-06-22 14:45:00', 'c_updater': 'admin', 'c_is_remove': 0, 'c_rule_class': 1, 'c_use_status': 1, 'dlpStrategyList': []}, {'c_id': 'data_feature_rule_10', 'c_rule_name': '燃气用户编号12位数据内容匹配', 'c_rule_type': 2, 'c_rule_introduction': '燃气用户编号12位数据内容正则表达式', 'c_rule_content': '燃气用户编号12位数据内容正则表达式', 'c_create_time': '2022-06-22 14:45:00', 'c_creater': 'admin', 'c_update_time': '2022-06-22 14:45:00', 'c_updater': 'admin', 'c_is_remove': 0, 'c_rule_class': 1, 'c_use_status': 1, 'dlpStrategyList': []}, {'c_id': 'default_rule_14', 'c_rule_name': '手机号码规则', 'c_rule_type': 2, 'c_rule_introduction': '手机号码正则表达式', 'c_rule_content': '手机号码正则表达式', 'c_version': 1, 'c_sync_flag': 0, 'c_from_type': 2, 'c_create_time': '2021-04-15 18:53:03', 'c_creater': 'admin', 'c_update_time': '2021-05-13 14:24:29', 'c_updater': 'admin', 'c_note': '', 'c_is_remove': 0, 'c_rule_class': 1, 'c_use_status': 1, 'c_post_script': 'function check( str )\n-- trim space \nstr = string.gsub(str,"%s+","")\n-- check length \nlocal length = string.len( str )\nif 11 ~= length \nthen return 0 \nend \n--check first char \nlocal arrEndStr = {"130","131","132","133","134","135","136","137","138","139","145","147","149","150","151","152","153","155","156","157","158","159"," 170","171","173","175","176","177","178","180","181","182","183","184","185","186","187","188","189","166","198","199"\n}\nlocal bMatch=0 \nfor j=1,42 do \nif arrEndStr[j] == string.sub( str, 1, 3 ) \nthen bMatch=1 break \nend \nend  \nif bMatch==0 \nthen \nreturn 0  \nend \n-- success \nreturn 1 \nend', 'dlpStrategyList': []}, {'c_id': 'default_rule_3', 'c_rule_name': '税务登记号18位规则', 'c_rule_type': 2, 'c_rule_introduction': '税务登记号18位正则表达式', 'c_rule_content': '税务登记号18位正则表达式', 'c_version': 1, 'c_sync_flag': 0, 'c_from_type': 2, 'c_create_time': '2021-04-15 18:53:03', 'c_creater': 'admin', 'c_update_time': '2021-05-13 14:23:51', 'c_updater': 'admin', 'c_note': '', 'c_is_remove': 0, 'c_rule_class': 1, 'c_use_status': 1, 'c_post_script': 'function check(str)\n    local strLen = string.len(str);\n    if(strLen ~= 18) then\n        return 0;\n    end\n\n    local wv = "0123456789ABCDEFGHJKLMNPQRTUWXY";\n    local ws = {1, 3, 9, 27, 19, 26, 16, 17, 20, 29, 25, 13, 8, 24, 10, 30, 28};\n    local codes = {};\n    codes[0] = string.sub(str, 1, string.len(str)-1);\n    codes[1] = string.sub(str, string.len(str), string.len(str));\n\n    local sum = 0;\n    for i=1,17 do\n        local wsValue = ws[i];\n        local wvValue = string.find(wv,string.sub(str,i,i),1)-1;\n         sum = sum+wvValue*wsValue;\n    end\n\n    local c18 = 31-(sum%31);\n    if(c18 == 31) then\n        c18 = 0;\n    end\n\n    local strCharAtC18 = string.sub(wv, c18+1, c18+1);\n    local codeCharAt0 = string.sub(codes[1],1,1);\n\n    if(strCharAtC18 ~= codeCharAt0) then\n        return 0;\n    end\n\n    return 1;\nend', 'dlpStrategyList': []}, {'c_id': 'default_rule_22', 'c_rule_name': '身份证规则', 'c_rule_type': 2, 'c_rule_introduction': '身份证正则表达式', 'c_rule_content': '身份证正则表达式', 'c_version': 1, 'c_sync_flag': 0, 'c_from_type': 2, 'c_create_time': '2021-04-15 18:53:03', 'c_creater': 'admin', 'c_update_time': '2021-04-30 16:38:15', 'c_updater': 'admin', 'c_note': '', 'c_is_remove': 0, 'c_rule_class': 1, 'c_use_status': 1, 'c_post_script': "function check(str)\nstr=string.upper(str)\n-- check length\nlocal length = string.len( str )\nif 18 ~= length then\nreturn 0\nend\n-- check province\nlocal province = string.sub( str, 1, 6 )\n-- check birthday\nlocal birthday = string.sub( str, 7, 14 )\nlocal y = tonumber( string.sub( birthday, 1, 4 ) )\nlocal m = tonumber( string.sub( birthday, 5, 6 ) )\nlocal d = tonumber( string.sub( birthday, 7, 8 ) )\nif (y<1900 or y>2100 or m<1 or m>12 or d>32)\nthen\nreturn 0\nend\n-- check checksum\nchecksum = 0;\nlocal weights = { 7, 9, 10, 5, 8, 4, 2, 1, 6, 3, 7, 9, 10, 5, 8, 4, 2 }\nlocal i = 1\nwhile i < length do\nlocal digit = tonumber( string.sub( str, i, i ) ) * weights[i]\nchecksum = checksum + digit\ni = i + 1\nend\nchecksum = checksum % 11\nlocal checksums = { '1', '0', 'X', '9', '8', '7', '6', '5', '4', '3', '2' }\nif checksums[checksum + 1] ~= string.sub( str, length ) \nthen return 0\nend\n-- success\nreturn 1\nend", 'dlpStrategyList': []}, {'c_id': 'default_rule_20', 'c_rule_name': '座机电话号码规则', 'c_rule_type': 2, 'c_rule_introduction': '座机电话号码正则表达式', 'c_rule_content': '座机电话号码正则表达式', 'c_version': 1, 'c_sync_flag': 0, 'c_from_type': 2, 'c_create_time': '2021-04-15 18:53:03', 'c_creater': 'admin', 'c_update_time': '2021-04-30 16:37:45', 'c_updater': 'admin', 'c_note': '', 'c_is_remove': 0, 'c_rule_class': 1, 'c_use_status': 1, 'c_post_script': 'function check( str )\n\nlocal arrEndStr = {"010","020","021","022","023","024","025","027","028","029","031","033","035","037","039","041","042","043","044","045","047","048","051","052","053","055","056","057","058","059","066","069","069","070","071","072","073","074","075","076","077","079","081","082","083","084","085","087","088","089","089","090","091","093","094","095","097","099"}\nlocal bMatch=0 \nfor j=1,table.getn(arrEndStr) do \nif arrEndStr[j] == string.sub( str, 2, 4 ) \nthen bMatch=1 break \nend \nif arrEndStr[j] == string.sub( str, 1, 3 ) \nthen bMatch=1 break \nend \nend  \nif bMatch==0 \nthen \nreturn 0  \nend \n-- calculate Luhn check sum \n\n-- success \nreturn 1 \nend\n\na1 = "010-68385769"\na2 = "(010)-68598569"\nb = check(a1)\nprint(b)', 'dlpStrategyList': []}, {'c_id': 'default_rule_10', 'c_rule_name': '银行卡16位和19位规则', 'c_rule_type': 2, 'c_rule_introduction': '银行卡16位和19位正则表达式', 'c_rule_content': '银行卡16位和19位正则表达式', 'c_version': 1, 'c_sync_flag': 0, 'c_from_type': 2, 'c_create_time': '2021-04-15 18:53:03', 'c_creater': 'admin', 'c_update_time': '2021-04-30 16:35:51', 'c_updater': 'admin', 'c_note': '', 'c_is_remove': 0, 'c_rule_class': 1, 'c_use_status': 1, 'c_post_script': 'function check( str )\n-- trim space \nstr = string.gsub(str,"%s+","")\n-- check length \nlocal length = string.len( str )\nif 16 ~= length and 19 ~= length \nthen return 0 \nend \n-- calculate Luhn check sum \nlocal checksum = 0 \nlocal ratio = ( 0 == length % 2 ) and 2 or 1 \nlocal i = 1 \nwhile i <= length do \nlocal digit = tonumber( string.sub( str, i, i ) ) * ratio if digit > 9 then digit = digit - 9  \nend \nchecksum = checksum + digit \nratio = ( 1 == ratio ) and 2 or 1 i = i + 1 \nend\nchecksum = checksum % 10  \nif 0 ~= checksum \nthen return 0  \nend  \n-- success \nreturn 1 \nend', 'dlpStrategyList': []}, {'c_id': 'default_rule_8', 'c_rule_name': '税务登记号15位规则', 'c_rule_type': 2, 'c_rule_introduction': '税务登记号15位正则表达式', 'c_rule_content': '税务登记号15位正则表达式', 'c_version': 1, 'c_sync_flag': 0, 'c_from_type': 2, 'c_create_time': '2021-04-15 18:53:03', 'c_creater': 'admin', 'c_update_time': '2021-04-30 16:35:24', 'c_updater': 'admin', 'c_note': '', 'c_is_remove': 0, 'c_rule_class': 1, 'c_use_status': 1, 'c_post_script': "function addressCode_tax(str)\n    local tempNum = tonumber(string.sub(str, 1, 2))\n   if 11 > tempNum or tempNum > 82 or (tempNum > 15 and 21 > tempNum) or (tempNum > 23 and 31 > tempNum) or (tempNum > 37 and 41 > tempNum) or (tempNum > 46 and 50 > tempNum) or (tempNum > 54 and 61 > tempNum) or (tempNum > 65 and 71 > tempNum) or (tempNum > 71 and 81 > tempNum) then\n     return false\n  else \n     return true\n   end\nend\n\n\nfunction numstrToArry_tax(str)\n  local tempStr = string.sub(str, 7, 15)\n    local matchArry = {1, 2, 3, 4, 5, 6, 7, 8, 9, 'A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'G', 'K', 'L', 'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z'}\n   local resultArry = {}\n for i=1, 8 do\n     local tempChar = string.sub(tempStr, i, i)\n        local charByte = string.byte(tempChar)\n        if charByte >= 65 and 90 >= charByte then\n         for j=10, 35 do\n               if matchArry[j] == tempChar then\n                  resultArry[i] = j\n                 break\n             end\n           end\n       elseif charByte >= 48 and 57 >= charByte then\n         resultArry[i] = tonumber(tempChar)  \n      end\n   end\n   if string.sub(tempStr, 9, 9) == 'X' then\n        resultArry[9] = 10\n    else\n      resultArry[9] = tonumber(string.sub(tempStr, 9, 9))\n   end\n   return resultArry\nend\n\n\n\nfunction testGroup_tax(str)\n local weightArry = {3, 7, 9, 10, 5, 8, 4, 2}\n  local numArry = numstrToArry_tax(str)\n local tempSum = 0\n for j=1, 8 do\n     tempSum = tempSum + (numArry[j] * weightArry[j])\n  end\n   local c9 = 11 - (tempSum % 11)\n    if c9 == numArry[9] then\n      return true\n   else\n      return false\n  end\nend\n\n\nfunction check(str)\n if addressCode_tax(str) and testGroup_tax(str) then\n       return 1\n  else\n      return 0\n  end\nend", 'dlpStrategyList': []}, {'c_id': 'default_rule_2', 'c_rule_name': '营业执照规则', 'c_rule_type': 2, 'c_rule_introduction': '营业执照正则表达式', 'c_rule_content': '营业执照正则表达式', 'c_version': 1, 'c_sync_flag': 0, 'c_from_type': 2, 'c_create_time': '2021-04-15 18:53:03', 'c_creater': 'admin', 'c_update_time': '2021-04-30 16:33:02', 'c_updater': 'admin', 'c_note': '', 'c_is_remove': 0, 'c_rule_class': 1, 'c_use_status': 1, 'c_post_script': 'function check(str)\n local flag = 1 \n local s = {} \n local p = {} \n local a = {} \n p[1] = 10 \n for i=1, 15 do \n a[i] = tonumber(string.sub(str, i, i)) s[i] = (p[i] % 11) + a[i] \n if 0 == s[i] % 10 \n then p[i + 1] = 10 * 2 \n else p[i + 1] = (s[i] % 10) * 2 \n end \n end \n if 1 ~= s[15] % 10 \n then flag = 0 \n end \n return flag \n end', 'dlpStrategyList': []}], 'total': 27}}
[32mINFO    [0m root:checkresult.py:152 code断言通过, 期望状态码:200, 实际状态码:200
[32mINFO    [0m root:checkresult.py:87 返回结果断言通过, 期望返回值:{'statusCode': 0}, 实际返回值:{'statusCode': 0, 'data': {'resultList': [{'c_id': '8c571c8885074c88a44e58075539ec53', 'c_rule_name': '自动化测试正则规则', 'c_rule_type': 2, 'c_rule_content': '(?<!(手|工))测试', 'c_create_time': '2023-06-28 16:54:04', 'c_creater': 'admin', 'c_update_time': '2023-06-28 16:54:04', 'c_updater': 'admin', 'c_note': '不匹配自动化测试文本', 'c_is_remove': 0, 'c_rule_class': 2, 'c_use_status': 1, 'dlpStrategyList': [], 'c_traditional_match': 0}, {'c_id': 'default_rule_34', 'c_rule_name': '中国公务护照', 'c_rule_type': 2, 'c_rule_introduction': '中国公务护照正则表达式', 'c_rule_content': '中国公务护照正则表达式', 'c_version': 1, 'c_sync_flag': 0, 'c_from_type': 2, 'c_create_time': '2022-07-28 14:14:10', 'c_creater': 'admin', 'c_update_time': '2022-07-28 14:14:10', 'c_updater': 'admin', 'c_is_remove': 0, 'c_rule_class': 1, 'c_use_status': 1, 'dlpStrategyList': []}, {'c_id': 'default_rule_33', 'c_rule_name': '澳门特别行政区护照', 'c_rule_type': 2, 'c_rule_introduction': '澳门特别行政区护照正则表达式', 'c_rule_content': '澳门特别行政区护照正则表达式', 'c_version': 1, 'c_sync_flag': 0, 'c_from_type': 2, 'c_create_time': '2022-07-28 14:14:10', 'c_creater': 'admin', 'c_update_time': '2022-07-28 14:14:10', 'c_updater': 'admin', 'c_is_remove': 0, 'c_rule_class': 1, 'c_use_status': 1, 'dlpStrategyList': []}, {'c_id': 'default_rule_32', 'c_rule_name': '发动机号', 'c_rule_type': 2, 'c_rule_introduction': '发动机号正则表达式', 'c_rule_content': '发动机号正则表达式', 'c_version': 1, 'c_sync_flag': 0, 'c_from_type': 2, 'c_create_time': '2022-07-28 14:14:10', 'c_creater': 'admin', 'c_update_time': '2022-07-28 14:14:10', 'c_updater': 'admin', 'c_is_remove': 0, 'c_rule_class': 1, 'c_use_status': 1, 'dlpStrategyList': []}, {'c_id': 'default_rule_31', 'c_rule_name': '个人信用报告编号', 'c_rule_type': 2, 'c_rule_introduction': '个人信用报告编号正则表达式', 'c_rule_content': '个人信用报告编号正则表达式', 'c_version': 1, 'c_sync_flag': 0, 'c_from_type': 2, 'c_create_time': '2022-07-28 14:14:10', 'c_creater': 'admin', 'c_update_time': '2022-07-28 14:14:10', 'c_updater': 'admin', 'c_is_remove': 0, 'c_rule_class': 1, 'c_use_status': 1, 'dlpStrategyList': []}, {'c_id': 'default_rule_30', 'c_rule_name': '中国外交护照', 'c_rule_type': 2, 'c_rule_introduction': '中国外交护照正则表达式', 'c_rule_content': '中国外交护照正则表达式', 'c_version': 1, 'c_sync_flag': 0, 'c_from_type': 2, 'c_create_time': '2022-07-28 14:14:10', 'c_creater': 'admin', 'c_update_time': '2022-07-28 14:14:10', 'c_updater': 'admin', 'c_is_remove': 0, 'c_rule_class': 1, 'c_use_status': 1, 'dlpStrategyList': []}, {'c_id': 'default_rule_29', 'c_rule_name': '车架号', 'c_rule_type': 2, 'c_rule_introduction': '车架号正则表达式', 'c_rule_content': '车架号正则表达式', 'c_version': 1, 'c_sync_flag': 0, 'c_from_type': 2, 'c_create_time': '2022-07-28 14:14:10', 'c_creater': 'admin', 'c_update_time': '2022-07-28 14:14:10', 'c_updater': 'admin', 'c_is_remove': 0, 'c_rule_class': 1, 'c_use_status': 1, 'dlpStrategyList': []}, {'c_id': 'default_rule_28', 'c_rule_name': '车牌号', 'c_rule_type': 2, 'c_rule_introduction': '车牌号正则表达式', 'c_rule_content': '车牌号正则表达式', 'c_version': 1, 'c_sync_flag': 0, 'c_from_type': 2, 'c_create_time': '2022-07-28 14:14:10', 'c_creater': 'admin', 'c_update_time': '2022-07-28 14:14:10', 'c_updater': 'admin', 'c_is_remove': 0, 'c_rule_class': 1, 'c_use_status': 1, 'dlpStrategyList': []}, {'c_id': 'default_rule_27', 'c_rule_name': '军官证号', 'c_rule_type': 2, 'c_rule_introduction': '军官证号正则表达式', 'c_rule_content': '军官证号正则表达式', 'c_version': 1, 'c_sync_flag': 0, 'c_from_type': 2, 'c_create_time': '2022-07-28 14:14:10', 'c_creater': 'admin', 'c_update_time': '2022-07-28 14:14:10', 'c_updater': 'admin', 'c_is_remove': 0, 'c_rule_class': 1, 'c_use_status': 1, 'dlpStrategyList': []}, {'c_id': 'default_rule_26', 'c_rule_name': '香港特别行政区护照', 'c_rule_type': 2, 'c_rule_introduction': '香港特别行政区护照正则表达式', 'c_rule_content': '香港特别行政区护照正则表达式', 'c_version': 1, 'c_sync_flag': 0, 'c_from_type': 2, 'c_create_time': '2022-07-28 14:14:10', 'c_creater': 'admin', 'c_update_time': '2022-07-28 14:14:10', 'c_updater': 'admin', 'c_is_remove': 0, 'c_rule_class': 1, 'c_use_status': 1, 'dlpStrategyList': []}, {'c_id': 'default_rule_25', 'c_rule_name': '中国普通护照', 'c_rule_type': 2, 'c_rule_introduction': '中国普通护照正则表达式', 'c_rule_content': '中国普通护照正则表达式', 'c_version': 1, 'c_sync_flag': 0, 'c_from_type': 2, 'c_create_time': '2022-07-28 14:14:10', 'c_creater': 'admin', 'c_update_time': '2022-07-28 14:14:10', 'c_updater': 'admin', 'c_is_remove': 0, 'c_rule_class': 1, 'c_use_status': 1, 'dlpStrategyList': []}, {'c_id': 'data_feature_rule_9', 'c_rule_name': '燃气用户编号11位数据内容匹配', 'c_rule_type': 2, 'c_rule_introduction': '燃气用户编号11位数据内容正则表达式', 'c_rule_content': '燃气用户编号11位数据内容正则表达式', 'c_create_time': '2022-06-22 14:45:00', 'c_creater': 'admin', 'c_update_time': '2022-06-22 14:45:00', 'c_updater': 'admin', 'c_is_remove': 0, 'c_rule_class': 1, 'c_use_status': 1, 'dlpStrategyList': []}, {'c_id': 'data_feature_rule_10', 'c_rule_name': '燃气用户编号12位数据内容匹配', 'c_rule_type': 2, 'c_rule_introduction': '燃气用户编号12位数据内容正则表达式', 'c_rule_content': '燃气用户编号12位数据内容正则表达式', 'c_create_time': '2022-06-22 14:45:00', 'c_creater': 'admin', 'c_update_time': '2022-06-22 14:45:00', 'c_updater': 'admin', 'c_is_remove': 0, 'c_rule_class': 1, 'c_use_status': 1, 'dlpStrategyList': []}, {'c_id': 'default_rule_14', 'c_rule_name': '手机号码规则', 'c_rule_type': 2, 'c_rule_introduction': '手机号码正则表达式', 'c_rule_content': '手机号码正则表达式', 'c_version': 1, 'c_sync_flag': 0, 'c_from_type': 2, 'c_create_time': '2021-04-15 18:53:03', 'c_creater': 'admin', 'c_update_time': '2021-05-13 14:24:29', 'c_updater': 'admin', 'c_note': '', 'c_is_remove': 0, 'c_rule_class': 1, 'c_use_status': 1, 'c_post_script': 'function check( str )\n-- trim space \nstr = string.gsub(str,"%s+","")\n-- check length \nlocal length = string.len( str )\nif 11 ~= length \nthen return 0 \nend \n--check first char \nlocal arrEndStr = {"130","131","132","133","134","135","136","137","138","139","145","147","149","150","151","152","153","155","156","157","158","159"," 170","171","173","175","176","177","178","180","181","182","183","184","185","186","187","188","189","166","198","199"\n}\nlocal bMatch=0 \nfor j=1,42 do \nif arrEndStr[j] == string.sub( str, 1, 3 ) \nthen bMatch=1 break \nend \nend  \nif bMatch==0 \nthen \nreturn 0  \nend \n-- success \nreturn 1 \nend', 'dlpStrategyList': []}, {'c_id': 'default_rule_3', 'c_rule_name': '税务登记号18位规则', 'c_rule_type': 2, 'c_rule_introduction': '税务登记号18位正则表达式', 'c_rule_content': '税务登记号18位正则表达式', 'c_version': 1, 'c_sync_flag': 0, 'c_from_type': 2, 'c_create_time': '2021-04-15 18:53:03', 'c_creater': 'admin', 'c_update_time': '2021-05-13 14:23:51', 'c_updater': 'admin', 'c_note': '', 'c_is_remove': 0, 'c_rule_class': 1, 'c_use_status': 1, 'c_post_script': 'function check(str)\n    local strLen = string.len(str);\n    if(strLen ~= 18) then\n        return 0;\n    end\n\n    local wv = "0123456789ABCDEFGHJKLMNPQRTUWXY";\n    local ws = {1, 3, 9, 27, 19, 26, 16, 17, 20, 29, 25, 13, 8, 24, 10, 30, 28};\n    local codes = {};\n    codes[0] = string.sub(str, 1, string.len(str)-1);\n    codes[1] = string.sub(str, string.len(str), string.len(str));\n\n    local sum = 0;\n    for i=1,17 do\n        local wsValue = ws[i];\n        local wvValue = string.find(wv,string.sub(str,i,i),1)-1;\n         sum = sum+wvValue*wsValue;\n    end\n\n    local c18 = 31-(sum%31);\n    if(c18 == 31) then\n        c18 = 0;\n    end\n\n    local strCharAtC18 = string.sub(wv, c18+1, c18+1);\n    local codeCharAt0 = string.sub(codes[1],1,1);\n\n    if(strCharAtC18 ~= codeCharAt0) then\n        return 0;\n    end\n\n    return 1;\nend', 'dlpStrategyList': []}, {'c_id': 'default_rule_22', 'c_rule_name': '身份证规则', 'c_rule_type': 2, 'c_rule_introduction': '身份证正则表达式', 'c_rule_content': '身份证正则表达式', 'c_version': 1, 'c_sync_flag': 0, 'c_from_type': 2, 'c_create_time': '2021-04-15 18:53:03', 'c_creater': 'admin', 'c_update_time': '2021-04-30 16:38:15', 'c_updater': 'admin', 'c_note': '', 'c_is_remove': 0, 'c_rule_class': 1, 'c_use_status': 1, 'c_post_script': "function check(str)\nstr=string.upper(str)\n-- check length\nlocal length = string.len( str )\nif 18 ~= length then\nreturn 0\nend\n-- check province\nlocal province = string.sub( str, 1, 6 )\n-- check birthday\nlocal birthday = string.sub( str, 7, 14 )\nlocal y = tonumber( string.sub( birthday, 1, 4 ) )\nlocal m = tonumber( string.sub( birthday, 5, 6 ) )\nlocal d = tonumber( string.sub( birthday, 7, 8 ) )\nif (y<1900 or y>2100 or m<1 or m>12 or d>32)\nthen\nreturn 0\nend\n-- check checksum\nchecksum = 0;\nlocal weights = { 7, 9, 10, 5, 8, 4, 2, 1, 6, 3, 7, 9, 10, 5, 8, 4, 2 }\nlocal i = 1\nwhile i < length do\nlocal digit = tonumber( string.sub( str, i, i ) ) * weights[i]\nchecksum = checksum + digit\ni = i + 1\nend\nchecksum = checksum % 11\nlocal checksums = { '1', '0', 'X', '9', '8', '7', '6', '5', '4', '3', '2' }\nif checksums[checksum + 1] ~= string.sub( str, length ) \nthen return 0\nend\n-- success\nreturn 1\nend", 'dlpStrategyList': []}, {'c_id': 'default_rule_20', 'c_rule_name': '座机电话号码规则', 'c_rule_type': 2, 'c_rule_introduction': '座机电话号码正则表达式', 'c_rule_content': '座机电话号码正则表达式', 'c_version': 1, 'c_sync_flag': 0, 'c_from_type': 2, 'c_create_time': '2021-04-15 18:53:03', 'c_creater': 'admin', 'c_update_time': '2021-04-30 16:37:45', 'c_updater': 'admin', 'c_note': '', 'c_is_remove': 0, 'c_rule_class': 1, 'c_use_status': 1, 'c_post_script': 'function check( str )\n\nlocal arrEndStr = {"010","020","021","022","023","024","025","027","028","029","031","033","035","037","039","041","042","043","044","045","047","048","051","052","053","055","056","057","058","059","066","069","069","070","071","072","073","074","075","076","077","079","081","082","083","084","085","087","088","089","089","090","091","093","094","095","097","099"}\nlocal bMatch=0 \nfor j=1,table.getn(arrEndStr) do \nif arrEndStr[j] == string.sub( str, 2, 4 ) \nthen bMatch=1 break \nend \nif arrEndStr[j] == string.sub( str, 1, 3 ) \nthen bMatch=1 break \nend \nend  \nif bMatch==0 \nthen \nreturn 0  \nend \n-- calculate Luhn check sum \n\n-- success \nreturn 1 \nend\n\na1 = "010-68385769"\na2 = "(010)-68598569"\nb = check(a1)\nprint(b)', 'dlpStrategyList': []}, {'c_id': 'default_rule_10', 'c_rule_name': '银行卡16位和19位规则', 'c_rule_type': 2, 'c_rule_introduction': '银行卡16位和19位正则表达式', 'c_rule_content': '银行卡16位和19位正则表达式', 'c_version': 1, 'c_sync_flag': 0, 'c_from_type': 2, 'c_create_time': '2021-04-15 18:53:03', 'c_creater': 'admin', 'c_update_time': '2021-04-30 16:35:51', 'c_updater': 'admin', 'c_note': '', 'c_is_remove': 0, 'c_rule_class': 1, 'c_use_status': 1, 'c_post_script': 'function check( str )\n-- trim space \nstr = string.gsub(str,"%s+","")\n-- check length \nlocal length = string.len( str )\nif 16 ~= length and 19 ~= length \nthen return 0 \nend \n-- calculate Luhn check sum \nlocal checksum = 0 \nlocal ratio = ( 0 == length % 2 ) and 2 or 1 \nlocal i = 1 \nwhile i <= length do \nlocal digit = tonumber( string.sub( str, i, i ) ) * ratio if digit > 9 then digit = digit - 9  \nend \nchecksum = checksum + digit \nratio = ( 1 == ratio ) and 2 or 1 i = i + 1 \nend\nchecksum = checksum % 10  \nif 0 ~= checksum \nthen return 0  \nend  \n-- success \nreturn 1 \nend', 'dlpStrategyList': []}, {'c_id': 'default_rule_8', 'c_rule_name': '税务登记号15位规则', 'c_rule_type': 2, 'c_rule_introduction': '税务登记号15位正则表达式', 'c_rule_content': '税务登记号15位正则表达式', 'c_version': 1, 'c_sync_flag': 0, 'c_from_type': 2, 'c_create_time': '2021-04-15 18:53:03', 'c_creater': 'admin', 'c_update_time': '2021-04-30 16:35:24', 'c_updater': 'admin', 'c_note': '', 'c_is_remove': 0, 'c_rule_class': 1, 'c_use_status': 1, 'c_post_script': "function addressCode_tax(str)\n    local tempNum = tonumber(string.sub(str, 1, 2))\n   if 11 > tempNum or tempNum > 82 or (tempNum > 15 and 21 > tempNum) or (tempNum > 23 and 31 > tempNum) or (tempNum > 37 and 41 > tempNum) or (tempNum > 46 and 50 > tempNum) or (tempNum > 54 and 61 > tempNum) or (tempNum > 65 and 71 > tempNum) or (tempNum > 71 and 81 > tempNum) then\n     return false\n  else \n     return true\n   end\nend\n\n\nfunction numstrToArry_tax(str)\n  local tempStr = string.sub(str, 7, 15)\n    local matchArry = {1, 2, 3, 4, 5, 6, 7, 8, 9, 'A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'G', 'K', 'L', 'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z'}\n   local resultArry = {}\n for i=1, 8 do\n     local tempChar = string.sub(tempStr, i, i)\n        local charByte = string.byte(tempChar)\n        if charByte >= 65 and 90 >= charByte then\n         for j=10, 35 do\n               if matchArry[j] == tempChar then\n                  resultArry[i] = j\n                 break\n             end\n           end\n       elseif charByte >= 48 and 57 >= charByte then\n         resultArry[i] = tonumber(tempChar)  \n      end\n   end\n   if string.sub(tempStr, 9, 9) == 'X' then\n        resultArry[9] = 10\n    else\n      resultArry[9] = tonumber(string.sub(tempStr, 9, 9))\n   end\n   return resultArry\nend\n\n\n\nfunction testGroup_tax(str)\n local weightArry = {3, 7, 9, 10, 5, 8, 4, 2}\n  local numArry = numstrToArry_tax(str)\n local tempSum = 0\n for j=1, 8 do\n     tempSum = tempSum + (numArry[j] * weightArry[j])\n  end\n   local c9 = 11 - (tempSum % 11)\n    if c9 == numArry[9] then\n      return true\n   else\n      return false\n  end\nend\n\n\nfunction check(str)\n if addressCode_tax(str) and testGroup_tax(str) then\n       return 1\n  else\n      return 0\n  end\nend", 'dlpStrategyList': []}, {'c_id': 'default_rule_2', 'c_rule_name': '营业执照规则', 'c_rule_type': 2, 'c_rule_introduction': '营业执照正则表达式', 'c_rule_content': '营业执照正则表达式', 'c_version': 1, 'c_sync_flag': 0, 'c_from_type': 2, 'c_create_time': '2021-04-15 18:53:03', 'c_creater': 'admin', 'c_update_time': '2021-04-30 16:33:02', 'c_updater': 'admin', 'c_note': '', 'c_is_remove': 0, 'c_rule_class': 1, 'c_use_status': 1, 'c_post_script': 'function check(str)\n local flag = 1 \n local s = {} \n local p = {} \n local a = {} \n p[1] = 10 \n for i=1, 15 do \n a[i] = tonumber(string.sub(str, i, i)) s[i] = (p[i] % 11) + a[i] \n if 0 == s[i] % 10 \n then p[i + 1] = 10 * 2 \n else p[i + 1] = (s[i] % 10) * 2 \n end \n end \n if 1 ~= s[15] % 10 \n then flag = 0 \n end \n return flag \n end', 'dlpStrategyList': []}], 'total': 27}}
[32mINFO    [0m root:checkresult.py:130 json断言通过, 期望结果'{'path': '$.data.resultList[0].c_rule_name', 'value': '自动化测试', 'type': 'in'}', 实际结果'{'statusCode': 0, 'data': {'resultList': [{'c_id': '8c571c8885074c88a44e58075539ec53', 'c_rule_name': '自动化测试正则规则', 'c_rule_type': 2, 'c_rule_content': '(?<!(手|工))测试', 'c_create_time': '2023-06-28 16:54:04', 'c_creater': 'admin', 'c_update_time': '2023-06-28 16:54:04', 'c_updater': 'admin', 'c_note': '不匹配自动化测试文本', 'c_is_remove': 0, 'c_rule_class': 2, 'c_use_status': 1, 'dlpStrategyList': [], 'c_traditional_match': 0}, {'c_id': 'default_rule_34', 'c_rule_name': '中国公务护照', 'c_rule_type': 2, 'c_rule_introduction': '中国公务护照正则表达式', 'c_rule_content': '中国公务护照正则表达式', 'c_version': 1, 'c_sync_flag': 0, 'c_from_type': 2, 'c_create_time': '2022-07-28 14:14:10', 'c_creater': 'admin', 'c_update_time': '2022-07-28 14:14:10', 'c_updater': 'admin', 'c_is_remove': 0, 'c_rule_class': 1, 'c_use_status': 1, 'dlpStrategyList': []}, {'c_id': 'default_rule_33', 'c_rule_name': '澳门特别行政区护照', 'c_rule_type': 2, 'c_rule_introduction': '澳门特别行政区护照正则表达式', 'c_rule_content': '澳门特别行政区护照正则表达式', 'c_version': 1, 'c_sync_flag': 0, 'c_from_type': 2, 'c_create_time': '2022-07-28 14:14:10', 'c_creater': 'admin', 'c_update_time': '2022-07-28 14:14:10', 'c_updater': 'admin', 'c_is_remove': 0, 'c_rule_class': 1, 'c_use_status': 1, 'dlpStrategyList': []}, {'c_id': 'default_rule_32', 'c_rule_name': '发动机号', 'c_rule_type': 2, 'c_rule_introduction': '发动机号正则表达式', 'c_rule_content': '发动机号正则表达式', 'c_version': 1, 'c_sync_flag': 0, 'c_from_type': 2, 'c_create_time': '2022-07-28 14:14:10', 'c_creater': 'admin', 'c_update_time': '2022-07-28 14:14:10', 'c_updater': 'admin', 'c_is_remove': 0, 'c_rule_class': 1, 'c_use_status': 1, 'dlpStrategyList': []}, {'c_id': 'default_rule_31', 'c_rule_name': '个人信用报告编号', 'c_rule_type': 2, 'c_rule_introduction': '个人信用报告编号正则表达式', 'c_rule_content': '个人信用报告编号正则表达式', 'c_version': 1, 'c_sync_flag': 0, 'c_from_type': 2, 'c_create_time': '2022-07-28 14:14:10', 'c_creater': 'admin', 'c_update_time': '2022-07-28 14:14:10', 'c_updater': 'admin', 'c_is_remove': 0, 'c_rule_class': 1, 'c_use_status': 1, 'dlpStrategyList': []}, {'c_id': 'default_rule_30', 'c_rule_name': '中国外交护照', 'c_rule_type': 2, 'c_rule_introduction': '中国外交护照正则表达式', 'c_rule_content': '中国外交护照正则表达式', 'c_version': 1, 'c_sync_flag': 0, 'c_from_type': 2, 'c_create_time': '2022-07-28 14:14:10', 'c_creater': 'admin', 'c_update_time': '2022-07-28 14:14:10', 'c_updater': 'admin', 'c_is_remove': 0, 'c_rule_class': 1, 'c_use_status': 1, 'dlpStrategyList': []}, {'c_id': 'default_rule_29', 'c_rule_name': '车架号', 'c_rule_type': 2, 'c_rule_introduction': '车架号正则表达式', 'c_rule_content': '车架号正则表达式', 'c_version': 1, 'c_sync_flag': 0, 'c_from_type': 2, 'c_create_time': '2022-07-28 14:14:10', 'c_creater': 'admin', 'c_update_time': '2022-07-28 14:14:10', 'c_updater': 'admin', 'c_is_remove': 0, 'c_rule_class': 1, 'c_use_status': 1, 'dlpStrategyList': []}, {'c_id': 'default_rule_28', 'c_rule_name': '车牌号', 'c_rule_type': 2, 'c_rule_introduction': '车牌号正则表达式', 'c_rule_content': '车牌号正则表达式', 'c_version': 1, 'c_sync_flag': 0, 'c_from_type': 2, 'c_create_time': '2022-07-28 14:14:10', 'c_creater': 'admin', 'c_update_time': '2022-07-28 14:14:10', 'c_updater': 'admin', 'c_is_remove': 0, 'c_rule_class': 1, 'c_use_status': 1, 'dlpStrategyList': []}, {'c_id': 'default_rule_27', 'c_rule_name': '军官证号', 'c_rule_type': 2, 'c_rule_introduction': '军官证号正则表达式', 'c_rule_content': '军官证号正则表达式', 'c_version': 1, 'c_sync_flag': 0, 'c_from_type': 2, 'c_create_time': '2022-07-28 14:14:10', 'c_creater': 'admin', 'c_update_time': '2022-07-28 14:14:10', 'c_updater': 'admin', 'c_is_remove': 0, 'c_rule_class': 1, 'c_use_status': 1, 'dlpStrategyList': []}, {'c_id': 'default_rule_26', 'c_rule_name': '香港特别行政区护照', 'c_rule_type': 2, 'c_rule_introduction': '香港特别行政区护照正则表达式', 'c_rule_content': '香港特别行政区护照正则表达式', 'c_version': 1, 'c_sync_flag': 0, 'c_from_type': 2, 'c_create_time': '2022-07-28 14:14:10', 'c_creater': 'admin', 'c_update_time': '2022-07-28 14:14:10', 'c_updater': 'admin', 'c_is_remove': 0, 'c_rule_class': 1, 'c_use_status': 1, 'dlpStrategyList': []}, {'c_id': 'default_rule_25', 'c_rule_name': '中国普通护照', 'c_rule_type': 2, 'c_rule_introduction': '中国普通护照正则表达式', 'c_rule_content': '中国普通护照正则表达式', 'c_version': 1, 'c_sync_flag': 0, 'c_from_type': 2, 'c_create_time': '2022-07-28 14:14:10', 'c_creater': 'admin', 'c_update_time': '2022-07-28 14:14:10', 'c_updater': 'admin', 'c_is_remove': 0, 'c_rule_class': 1, 'c_use_status': 1, 'dlpStrategyList': []}, {'c_id': 'data_feature_rule_9', 'c_rule_name': '燃气用户编号11位数据内容匹配', 'c_rule_type': 2, 'c_rule_introduction': '燃气用户编号11位数据内容正则表达式', 'c_rule_content': '燃气用户编号11位数据内容正则表达式', 'c_create_time': '2022-06-22 14:45:00', 'c_creater': 'admin', 'c_update_time': '2022-06-22 14:45:00', 'c_updater': 'admin', 'c_is_remove': 0, 'c_rule_class': 1, 'c_use_status': 1, 'dlpStrategyList': []}, {'c_id': 'data_feature_rule_10', 'c_rule_name': '燃气用户编号12位数据内容匹配', 'c_rule_type': 2, 'c_rule_introduction': '燃气用户编号12位数据内容正则表达式', 'c_rule_content': '燃气用户编号12位数据内容正则表达式', 'c_create_time': '2022-06-22 14:45:00', 'c_creater': 'admin', 'c_update_time': '2022-06-22 14:45:00', 'c_updater': 'admin', 'c_is_remove': 0, 'c_rule_class': 1, 'c_use_status': 1, 'dlpStrategyList': []}, {'c_id': 'default_rule_14', 'c_rule_name': '手机号码规则', 'c_rule_type': 2, 'c_rule_introduction': '手机号码正则表达式', 'c_rule_content': '手机号码正则表达式', 'c_version': 1, 'c_sync_flag': 0, 'c_from_type': 2, 'c_create_time': '2021-04-15 18:53:03', 'c_creater': 'admin', 'c_update_time': '2021-05-13 14:24:29', 'c_updater': 'admin', 'c_note': '', 'c_is_remove': 0, 'c_rule_class': 1, 'c_use_status': 1, 'c_post_script': 'function check( str )\n-- trim space \nstr = string.gsub(str,"%s+","")\n-- check length \nlocal length = string.len( str )\nif 11 ~= length \nthen return 0 \nend \n--check first char \nlocal arrEndStr = {"130","131","132","133","134","135","136","137","138","139","145","147","149","150","151","152","153","155","156","157","158","159"," 170","171","173","175","176","177","178","180","181","182","183","184","185","186","187","188","189","166","198","199"\n}\nlocal bMatch=0 \nfor j=1,42 do \nif arrEndStr[j] == string.sub( str, 1, 3 ) \nthen bMatch=1 break \nend \nend  \nif bMatch==0 \nthen \nreturn 0  \nend \n-- success \nreturn 1 \nend', 'dlpStrategyList': []}, {'c_id': 'default_rule_3', 'c_rule_name': '税务登记号18位规则', 'c_rule_type': 2, 'c_rule_introduction': '税务登记号18位正则表达式', 'c_rule_content': '税务登记号18位正则表达式', 'c_version': 1, 'c_sync_flag': 0, 'c_from_type': 2, 'c_create_time': '2021-04-15 18:53:03', 'c_creater': 'admin', 'c_update_time': '2021-05-13 14:23:51', 'c_updater': 'admin', 'c_note': '', 'c_is_remove': 0, 'c_rule_class': 1, 'c_use_status': 1, 'c_post_script': 'function check(str)\n    local strLen = string.len(str);\n    if(strLen ~= 18) then\n        return 0;\n    end\n\n    local wv = "0123456789ABCDEFGHJKLMNPQRTUWXY";\n    local ws = {1, 3, 9, 27, 19, 26, 16, 17, 20, 29, 25, 13, 8, 24, 10, 30, 28};\n    local codes = {};\n    codes[0] = string.sub(str, 1, string.len(str)-1);\n    codes[1] = string.sub(str, string.len(str), string.len(str));\n\n    local sum = 0;\n    for i=1,17 do\n        local wsValue = ws[i];\n        local wvValue = string.find(wv,string.sub(str,i,i),1)-1;\n         sum = sum+wvValue*wsValue;\n    end\n\n    local c18 = 31-(sum%31);\n    if(c18 == 31) then\n        c18 = 0;\n    end\n\n    local strCharAtC18 = string.sub(wv, c18+1, c18+1);\n    local codeCharAt0 = string.sub(codes[1],1,1);\n\n    if(strCharAtC18 ~= codeCharAt0) then\n        return 0;\n    end\n\n    return 1;\nend', 'dlpStrategyList': []}, {'c_id': 'default_rule_22', 'c_rule_name': '身份证规则', 'c_rule_type': 2, 'c_rule_introduction': '身份证正则表达式', 'c_rule_content': '身份证正则表达式', 'c_version': 1, 'c_sync_flag': 0, 'c_from_type': 2, 'c_create_time': '2021-04-15 18:53:03', 'c_creater': 'admin', 'c_update_time': '2021-04-30 16:38:15', 'c_updater': 'admin', 'c_note': '', 'c_is_remove': 0, 'c_rule_class': 1, 'c_use_status': 1, 'c_post_script': "function check(str)\nstr=string.upper(str)\n-- check length\nlocal length = string.len( str )\nif 18 ~= length then\nreturn 0\nend\n-- check province\nlocal province = string.sub( str, 1, 6 )\n-- check birthday\nlocal birthday = string.sub( str, 7, 14 )\nlocal y = tonumber( string.sub( birthday, 1, 4 ) )\nlocal m = tonumber( string.sub( birthday, 5, 6 ) )\nlocal d = tonumber( string.sub( birthday, 7, 8 ) )\nif (y<1900 or y>2100 or m<1 or m>12 or d>32)\nthen\nreturn 0\nend\n-- check checksum\nchecksum = 0;\nlocal weights = { 7, 9, 10, 5, 8, 4, 2, 1, 6, 3, 7, 9, 10, 5, 8, 4, 2 }\nlocal i = 1\nwhile i < length do\nlocal digit = tonumber( string.sub( str, i, i ) ) * weights[i]\nchecksum = checksum + digit\ni = i + 1\nend\nchecksum = checksum % 11\nlocal checksums = { '1', '0', 'X', '9', '8', '7', '6', '5', '4', '3', '2' }\nif checksums[checksum + 1] ~= string.sub( str, length ) \nthen return 0\nend\n-- success\nreturn 1\nend", 'dlpStrategyList': []}, {'c_id': 'default_rule_20', 'c_rule_name': '座机电话号码规则', 'c_rule_type': 2, 'c_rule_introduction': '座机电话号码正则表达式', 'c_rule_content': '座机电话号码正则表达式', 'c_version': 1, 'c_sync_flag': 0, 'c_from_type': 2, 'c_create_time': '2021-04-15 18:53:03', 'c_creater': 'admin', 'c_update_time': '2021-04-30 16:37:45', 'c_updater': 'admin', 'c_note': '', 'c_is_remove': 0, 'c_rule_class': 1, 'c_use_status': 1, 'c_post_script': 'function check( str )\n\nlocal arrEndStr = {"010","020","021","022","023","024","025","027","028","029","031","033","035","037","039","041","042","043","044","045","047","048","051","052","053","055","056","057","058","059","066","069","069","070","071","072","073","074","075","076","077","079","081","082","083","084","085","087","088","089","089","090","091","093","094","095","097","099"}\nlocal bMatch=0 \nfor j=1,table.getn(arrEndStr) do \nif arrEndStr[j] == string.sub( str, 2, 4 ) \nthen bMatch=1 break \nend \nif arrEndStr[j] == string.sub( str, 1, 3 ) \nthen bMatch=1 break \nend \nend  \nif bMatch==0 \nthen \nreturn 0  \nend \n-- calculate Luhn check sum \n\n-- success \nreturn 1 \nend\n\na1 = "010-68385769"\na2 = "(010)-68598569"\nb = check(a1)\nprint(b)', 'dlpStrategyList': []}, {'c_id': 'default_rule_10', 'c_rule_name': '银行卡16位和19位规则', 'c_rule_type': 2, 'c_rule_introduction': '银行卡16位和19位正则表达式', 'c_rule_content': '银行卡16位和19位正则表达式', 'c_version': 1, 'c_sync_flag': 0, 'c_from_type': 2, 'c_create_time': '2021-04-15 18:53:03', 'c_creater': 'admin', 'c_update_time': '2021-04-30 16:35:51', 'c_updater': 'admin', 'c_note': '', 'c_is_remove': 0, 'c_rule_class': 1, 'c_use_status': 1, 'c_post_script': 'function check( str )\n-- trim space \nstr = string.gsub(str,"%s+","")\n-- check length \nlocal length = string.len( str )\nif 16 ~= length and 19 ~= length \nthen return 0 \nend \n-- calculate Luhn check sum \nlocal checksum = 0 \nlocal ratio = ( 0 == length % 2 ) and 2 or 1 \nlocal i = 1 \nwhile i <= length do \nlocal digit = tonumber( string.sub( str, i, i ) ) * ratio if digit > 9 then digit = digit - 9  \nend \nchecksum = checksum + digit \nratio = ( 1 == ratio ) and 2 or 1 i = i + 1 \nend\nchecksum = checksum % 10  \nif 0 ~= checksum \nthen return 0  \nend  \n-- success \nreturn 1 \nend', 'dlpStrategyList': []}, {'c_id': 'default_rule_8', 'c_rule_name': '税务登记号15位规则', 'c_rule_type': 2, 'c_rule_introduction': '税务登记号15位正则表达式', 'c_rule_content': '税务登记号15位正则表达式', 'c_version': 1, 'c_sync_flag': 0, 'c_from_type': 2, 'c_create_time': '2021-04-15 18:53:03', 'c_creater': 'admin', 'c_update_time': '2021-04-30 16:35:24', 'c_updater': 'admin', 'c_note': '', 'c_is_remove': 0, 'c_rule_class': 1, 'c_use_status': 1, 'c_post_script': "function addressCode_tax(str)\n    local tempNum = tonumber(string.sub(str, 1, 2))\n   if 11 > tempNum or tempNum > 82 or (tempNum > 15 and 21 > tempNum) or (tempNum > 23 and 31 > tempNum) or (tempNum > 37 and 41 > tempNum) or (tempNum > 46 and 50 > tempNum) or (tempNum > 54 and 61 > tempNum) or (tempNum > 65 and 71 > tempNum) or (tempNum > 71 and 81 > tempNum) then\n     return false\n  else \n     return true\n   end\nend\n\n\nfunction numstrToArry_tax(str)\n  local tempStr = string.sub(str, 7, 15)\n    local matchArry = {1, 2, 3, 4, 5, 6, 7, 8, 9, 'A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'G', 'K', 'L', 'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z'}\n   local resultArry = {}\n for i=1, 8 do\n     local tempChar = string.sub(tempStr, i, i)\n        local charByte = string.byte(tempChar)\n        if charByte >= 65 and 90 >= charByte then\n         for j=10, 35 do\n               if matchArry[j] == tempChar then\n                  resultArry[i] = j\n                 break\n             end\n           end\n       elseif charByte >= 48 and 57 >= charByte then\n         resultArry[i] = tonumber(tempChar)  \n      end\n   end\n   if string.sub(tempStr, 9, 9) == 'X' then\n        resultArry[9] = 10\n    else\n      resultArry[9] = tonumber(string.sub(tempStr, 9, 9))\n   end\n   return resultArry\nend\n\n\n\nfunction testGroup_tax(str)\n local weightArry = {3, 7, 9, 10, 5, 8, 4, 2}\n  local numArry = numstrToArry_tax(str)\n local tempSum = 0\n for j=1, 8 do\n     tempSum = tempSum + (numArry[j] * weightArry[j])\n  end\n   local c9 = 11 - (tempSum % 11)\n    if c9 == numArry[9] then\n      return true\n   else\n      return false\n  end\nend\n\n\nfunction check(str)\n if addressCode_tax(str) and testGroup_tax(str) then\n       return 1\n  else\n      return 0\n  end\nend", 'dlpStrategyList': []}, {'c_id': 'default_rule_2', 'c_rule_name': '营业执照规则', 'c_rule_type': 2, 'c_rule_introduction': '营业执照正则表达式', 'c_rule_content': '营业执照正则表达式', 'c_version': 1, 'c_sync_flag': 0, 'c_from_type': 2, 'c_create_time': '2021-04-15 18:53:03', 'c_creater': 'admin', 'c_update_time': '2021-04-30 16:33:02', 'c_updater': 'admin', 'c_note': '', 'c_is_remove': 0, 'c_rule_class': 1, 'c_use_status': 1, 'c_post_script': 'function check(str)\n local flag = 1 \n local s = {} \n local p = {} \n local a = {} \n p[1] = 10 \n for i=1, 15 do \n a[i] = tonumber(string.sub(str, i, i)) s[i] = (p[i] % 11) + a[i] \n if 0 == s[i] % 10 \n then p[i + 1] = 10 * 2 \n else p[i + 1] = (s[i] % 10) * 2 \n end \n end \n if 1 ~= s[15] % 10 \n then flag = 0 \n end \n return flag \n end', 'dlpStrategyList': []}], 'total': 27}}'
[32mINFO    [0m root:runcase.py:61 -·-·-·-·-·-·-·-·-·-发送请求并接受信息 END-·-·-·-·-·-·-·-·-·-