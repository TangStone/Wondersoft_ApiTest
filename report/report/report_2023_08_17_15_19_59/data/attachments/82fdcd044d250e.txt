INFO     root:test_cases.py:43 ==========执行用例START：updateSyslogRule==========
INFO     root:runcase.py:42 -·-·-·-·-·-·-·-·-·-执行用例 START：修改syslog信息-·-·-·-·-·-·-·-·-·-
INFO     root:runcase.py:117 -·-·-·-·-·-·-·-·-·-执行接口 START：添加统一平台审计日志syslog规则-·-·-·-·-·-·-·-·-·-
INFO     root:handleyaml.py:84 Yaml测试用例基础架构检查通过
INFO     root:runcase.py:128 重组后的用例信息：{'api_name': '添加syslog列表', 'base_url': 'https://192.168.148.174:31000', 'request': {'method': 'POST', 'address': '/api/auth/v1/syslog/addSyslogRule', 'headers': {'Content-Type': 'application/x-www-form-urlencoded', 'token': 'eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzUxMiJ9.eyJhdWQiOiJhcHBsaWNhdGlvbiIsInN1YiI6IjRkMDRkZmY0LTY4MDgtNDMzOC1hNmM2LWJmZTJkMDM5OTkyMiIsImlzcyI6ImJtc19zZXJ2ZXIiLCJzZXNzaW9uSWQiOiI0ZDA0ZGZmNC02ODA4LTQzMzgtYTZjNi1iZmUyZDAzOTk5MjIiLCJleHAiOjE2OTI0MzYxOTIsImlhdCI6MTY5MjI1NjE5Mn0.APUzCdD6HYKQQBjoCl2IJUDUn6ZYZAKoPDCpsxspG8RuKBUbZZGE_AcoUz066Uu7vzTHapUiYfnM5LGhYABHoA', 'Referer': 'https://192.168.148.174:31000/sub-app-unity/syslogManage'}, 'data': {'ruleName': '自动化测试统一平台审计日志规则', 'sendType': '1', 'protocol': 'tcp', 'level': '6', 'type': '0', 'charCode': 'UTF-8', 'timeFormatter': '3', 'logPrefix': '统一平台syslog', 'customSeprChar': '+', 'serverInfos': '[{"ip":"192.168.154.7","port":"514"}]', 'syslogFields': '[{"metadataId":1000001,"fieldName":"createTime","indexPrefix":"system_admin_log_audit","platformId":"1","sortNum":0},{"metadataId":1000002,"fieldName":"adminName","indexPrefix":"system_admin_log_audit","platformId":"1","sortNum":1},{"metadataId":1000003,"fieldName":"sourceIp","indexPrefix":"system_admin_log_audit","platformId":"1","sortNum":2}]', 'appCode': 'system_admin_log_audit'}}, 'name': '添加统一平台审计日志syslog规则', 'description': '添加统一平台审计日志syslog规则', 'preProcessors': {'database': [{'type': 'mysql', 'sql': "delete from `bms-general-aa`.t_syslog_rule_info where ruleName like '自动化测试统一平台审计日志规则%';"}, {'type': 'mysql', 'sql': "delete from `bms-general-aa`.t_syslog_server_info where syslogRuleId in (select id from `bms-general-aa`.t_syslog_rule_info tsri where  ruleName like '自动化测试统一平台审计日志规则%');"}, {'type': 'mysql', 'sql': "delete from `bms-general-aa`.t_syslog_rule_fields_info where syslogRuleId in (select id from `bms-general-aa`.t_syslog_rule_info tsri where  ruleName like '自动化测试统一平台审计日志规则%');"}]}, 'postProcessors': {'assert': {'code': 200, 'response': {'result': 0, 'resultDesc': '操作成功', 'entityKey': 0}}}}
INFO     root:runcase.py:178 请求地址：https://192.168.148.174:31000/api/auth/v1/syslog/addSyslogRule
INFO     root:runcase.py:179 请求方法：POST
INFO     root:runcase.py:180 请求头：{'Content-Type': 'application/x-www-form-urlencoded', 'token': 'eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzUxMiJ9.eyJhdWQiOiJhcHBsaWNhdGlvbiIsInN1YiI6IjRkMDRkZmY0LTY4MDgtNDMzOC1hNmM2LWJmZTJkMDM5OTkyMiIsImlzcyI6ImJtc19zZXJ2ZXIiLCJzZXNzaW9uSWQiOiI0ZDA0ZGZmNC02ODA4LTQzMzgtYTZjNi1iZmUyZDAzOTk5MjIiLCJleHAiOjE2OTI0MzYxOTIsImlhdCI6MTY5MjI1NjE5Mn0.APUzCdD6HYKQQBjoCl2IJUDUn6ZYZAKoPDCpsxspG8RuKBUbZZGE_AcoUz066Uu7vzTHapUiYfnM5LGhYABHoA', 'Referer': 'https://192.168.148.174:31000/sub-app-unity/syslogManage'}
INFO     root:runcase.py:190 请求参数：{'ruleName': '自动化测试统一平台审计日志规则', 'sendType': '1', 'protocol': 'tcp', 'level': '6', 'type': '0', 'charCode': 'UTF-8', 'timeFormatter': '3', 'logPrefix': '统一平台syslog', 'customSeprChar': '+', 'serverInfos': '[{"ip":"192.168.154.7","port":"514"}]', 'syslogFields': '[{"metadataId":1000001,"fieldName":"createTime","indexPrefix":"system_admin_log_audit","platformId":"1","sortNum":0},{"metadataId":1000002,"fieldName":"adminName","indexPrefix":"system_admin_log_audit","platformId":"1","sortNum":1},{"metadataId":1000003,"fieldName":"sourceIp","indexPrefix":"system_admin_log_audit","platformId":"1","sortNum":2}]', 'appCode': 'system_admin_log_audit'}
INFO     root:runcase.py:252 请求接口结果： {'result': 0, 'resultDesc': '操作成功', 'entityKey': 0}
INFO     root:checkresult.py:152 code断言通过, 期望状态码:200, 实际状态码:200
INFO     root:checkresult.py:87 返回结果断言通过, 期望返回值:{'result': 0, 'resultDesc': '操作成功', 'entityKey': 0}, 实际返回值:{'result': 0, 'resultDesc': '操作成功', 'entityKey': 0}
INFO     root:runcase.py:135 -·-·-·-·-·-·-·-·-·-执行接口 END：添加统一平台审计日志syslog规则-·-·-·-·-·-·-·-·-·-
INFO     root:runcase.py:117 -·-·-·-·-·-·-·-·-·-执行接口 START：查看syslog规则集合-根据规则名称、状态筛选-·-·-·-·-·-·-·-·-·-
INFO     root:handleyaml.py:84 Yaml测试用例基础架构检查通过
INFO     root:runcase.py:128 重组后的用例信息：{'api_name': '查看syslog规则集合', 'base_url': 'https://192.168.148.174:31000', 'request': {'method': 'POST', 'address': '/api/auth/v1/syslog/querySyslogRuleList', 'headers': {'Content-Type': 'application/x-www-form-urlencoded', 'token': 'eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzUxMiJ9.eyJhdWQiOiJhcHBsaWNhdGlvbiIsInN1YiI6IjRkMDRkZmY0LTY4MDgtNDMzOC1hNmM2LWJmZTJkMDM5OTkyMiIsImlzcyI6ImJtc19zZXJ2ZXIiLCJzZXNzaW9uSWQiOiI0ZDA0ZGZmNC02ODA4LTQzMzgtYTZjNi1iZmUyZDAzOTk5MjIiLCJleHAiOjE2OTI0MzYxOTIsImlhdCI6MTY5MjI1NjE5Mn0.APUzCdD6HYKQQBjoCl2IJUDUn6ZYZAKoPDCpsxspG8RuKBUbZZGE_AcoUz066Uu7vzTHapUiYfnM5LGhYABHoA', 'Referer': 'https://192.168.148.174:31000/sub-app-unity/syslogManage'}, 'data': {'ruleName': '自动化测试统一平台审计日志规则', 'status': 0, 'page': 1, 'rows': 20}}, 'name': '查看syslog规则集合-根据规则名称、状态筛选', 'description': '查看syslog规则集合-根据规则名称、状态筛选', 'postProcessors': {'assert': {'code': 200, 'jsonpath': [{'path': '$.rows[0].ruleName', 'value': '自动化测试统一平台审计日志规则', 'type': 'in'}]}, 'extract': [{'name': 'id', 'jsonpath': '$.rows[0].id'}, {'name': 'ruleName', 'jsonpath': '$.rows[0].ruleName'}]}}
INFO     root:runcase.py:178 请求地址：https://192.168.148.174:31000/api/auth/v1/syslog/querySyslogRuleList
INFO     root:runcase.py:179 请求方法：POST
INFO     root:runcase.py:180 请求头：{'Content-Type': 'application/x-www-form-urlencoded', 'token': 'eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzUxMiJ9.eyJhdWQiOiJhcHBsaWNhdGlvbiIsInN1YiI6IjRkMDRkZmY0LTY4MDgtNDMzOC1hNmM2LWJmZTJkMDM5OTkyMiIsImlzcyI6ImJtc19zZXJ2ZXIiLCJzZXNzaW9uSWQiOiI0ZDA0ZGZmNC02ODA4LTQzMzgtYTZjNi1iZmUyZDAzOTk5MjIiLCJleHAiOjE2OTI0MzYxOTIsImlhdCI6MTY5MjI1NjE5Mn0.APUzCdD6HYKQQBjoCl2IJUDUn6ZYZAKoPDCpsxspG8RuKBUbZZGE_AcoUz066Uu7vzTHapUiYfnM5LGhYABHoA', 'Referer': 'https://192.168.148.174:31000/sub-app-unity/syslogManage'}
INFO     root:runcase.py:190 请求参数：{'ruleName': '自动化测试统一平台审计日志规则', 'status': 0, 'page': 1, 'rows': 20}
INFO     root:runcase.py:252 请求接口结果： {'total': 0, 'rows': [{'id': 140, 'modifyTime': '2023-08-17 15:14:27', 'ruleName': '自动化测试统一平台审计日志规则', 'sendType': 1, 'level': 6, 'type': 0, 'charCode': 'UTF-8', 'customSeprChar': '+', 'timeFormatter': 3, 'logPrefix': '统一平台syslog', 'status': 0, 'createUser': 'admin', 'modifyUser': 'admin', 'protocol': 'tcp', 'serverInfoEntityList': [{'id': 189, 'syslogRuleId': 140, 'modifyTime': '2023-08-17 15:14:28', 'ip': '192.168.154.7', 'port': 514}], 'syslogFieldsInfoEntityList': [{'id': 515, 'modifyTime': '2023-08-17 15:14:28', 'syslogRuleId': 140, 'metadataId': 1000001, 'fieldName': 'createTime', 'indexPrefix': 'system_admin_log_audit', 'sortNum': 0, 'platformId': '1', 'metadataName': '创建时间'}, {'id': 516, 'modifyTime': '2023-08-17 15:14:28', 'syslogRuleId': 140, 'metadataId': 1000002, 'fieldName': 'adminName', 'indexPrefix': 'system_admin_log_audit', 'sortNum': 1, 'platformId': '1', 'metadataName': '管理员账户名'}, {'id': 517, 'modifyTime': '2023-08-17 15:14:28', 'syslogRuleId': 140, 'metadataId': 1000003, 'fieldName': 'sourceIp', 'indexPrefix': 'system_admin_log_audit', 'sortNum': 2, 'platformId': '1', 'metadataName': '源ip'}]}]}
INFO     root:checkresult.py:152 code断言通过, 期望状态码:200, 实际状态码:200
INFO     root:checkresult.py:130 json断言通过, 期望结果'{'path': '$.rows[0].ruleName', 'value': '自动化测试统一平台审计日志规则', 'type': 'in'}', 实际结果'{'total': 0, 'rows': [{'id': 140, 'modifyTime': '2023-08-17 15:14:27', 'ruleName': '自动化测试统一平台审计日志规则', 'sendType': 1, 'level': 6, 'type': 0, 'charCode': 'UTF-8', 'customSeprChar': '+', 'timeFormatter': 3, 'logPrefix': '统一平台syslog', 'status': 0, 'createUser': 'admin', 'modifyUser': 'admin', 'protocol': 'tcp', 'serverInfoEntityList': [{'id': 189, 'syslogRuleId': 140, 'modifyTime': '2023-08-17 15:14:28', 'ip': '192.168.154.7', 'port': 514}], 'syslogFieldsInfoEntityList': [{'id': 515, 'modifyTime': '2023-08-17 15:14:28', 'syslogRuleId': 140, 'metadataId': 1000001, 'fieldName': 'createTime', 'indexPrefix': 'system_admin_log_audit', 'sortNum': 0, 'platformId': '1', 'metadataName': '创建时间'}, {'id': 516, 'modifyTime': '2023-08-17 15:14:28', 'syslogRuleId': 140, 'metadataId': 1000002, 'fieldName': 'adminName', 'indexPrefix': 'system_admin_log_audit', 'sortNum': 1, 'platformId': '1', 'metadataName': '管理员账户名'}, {'id': 517, 'modifyTime': '2023-08-17 15:14:28', 'syslogRuleId': 140, 'metadataId': 1000003, 'fieldName': 'sourceIp', 'indexPrefix': 'system_admin_log_audit', 'sortNum': 2, 'platformId': '1', 'metadataName': '源ip'}]}]}'
INFO     root:runcase.py:135 -·-·-·-·-·-·-·-·-·-执行接口 END：查看syslog规则集合-根据规则名称、状态筛选-·-·-·-·-·-·-·-·-·-
INFO     root:runcase.py:117 -·-·-·-·-·-·-·-·-·-执行接口 START：修改统一平台审计日志syslog规则-·-·-·-·-·-·-·-·-·-
INFO     root:handleyaml.py:84 Yaml测试用例基础架构检查通过
INFO     root:runcase.py:128 重组后的用例信息：{'api_name': '修改syslog信息', 'base_url': 'https://192.168.148.174:31000', 'request': {'method': 'POST', 'address': '/api/auth/v1/syslog/updateSyslogRule', 'headers': {'Content-Type': 'application/x-www-form-urlencoded', 'token': 'eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzUxMiJ9.eyJhdWQiOiJhcHBsaWNhdGlvbiIsInN1YiI6IjRkMDRkZmY0LTY4MDgtNDMzOC1hNmM2LWJmZTJkMDM5OTkyMiIsImlzcyI6ImJtc19zZXJ2ZXIiLCJzZXNzaW9uSWQiOiI0ZDA0ZGZmNC02ODA4LTQzMzgtYTZjNi1iZmUyZDAzOTk5MjIiLCJleHAiOjE2OTI0MzYxOTIsImlhdCI6MTY5MjI1NjE5Mn0.APUzCdD6HYKQQBjoCl2IJUDUn6ZYZAKoPDCpsxspG8RuKBUbZZGE_AcoUz066Uu7vzTHapUiYfnM5LGhYABHoA', 'Referer': 'https://192.168.148.174:31000/sub-app-unity/syslogManage'}, 'data': {'ruleName': '自动化测试统一平台审计日志规则', 'sendType': '2', 'protocol': 'udp', 'level': '7', 'type': '8', 'charCode': 'GBK', 'timeFormatter': '4', 'logPrefix': '统一平台syslog修改', 'customSeprChar': '++', 'serverInfos': '[{"ip":"192.168.154.77","port":"514"}]', 'syslogFields': '[{"metadataId":1000002,"fieldName":"adminName","indexPrefix":"system_admin_log_audit","platformId":"1","sortNum":1},{"metadataId":1000003,"fieldName":"sourceIp","indexPrefix":"system_admin_log_audit","platformId":"1","sortNum":2}]', 'appCode': 'system_admin_log_audit', 'id': '140'}}, 'name': '修改统一平台审计日志syslog规则', 'description': '修改统一平台审计日志syslog规则', 'postProcessors': {'assert': {'code': 200, 'response': {'result': 0, 'resultDesc': '操作成功', 'entityKey': 0}, 'dbcheck': [{'type': 'mysql', 'sql': "select * from `bms-general-aa`.t_syslog_rule_info tsri where id = '140'", 'result': [{'path': '$.protocol', 'value': 'udp'}, {'path': '$.logPrefix', 'value': '统一平台syslog修改'}]}]}}}
INFO     root:runcase.py:178 请求地址：https://192.168.148.174:31000/api/auth/v1/syslog/updateSyslogRule
INFO     root:runcase.py:179 请求方法：POST
INFO     root:runcase.py:180 请求头：{'Content-Type': 'application/x-www-form-urlencoded', 'token': 'eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzUxMiJ9.eyJhdWQiOiJhcHBsaWNhdGlvbiIsInN1YiI6IjRkMDRkZmY0LTY4MDgtNDMzOC1hNmM2LWJmZTJkMDM5OTkyMiIsImlzcyI6ImJtc19zZXJ2ZXIiLCJzZXNzaW9uSWQiOiI0ZDA0ZGZmNC02ODA4LTQzMzgtYTZjNi1iZmUyZDAzOTk5MjIiLCJleHAiOjE2OTI0MzYxOTIsImlhdCI6MTY5MjI1NjE5Mn0.APUzCdD6HYKQQBjoCl2IJUDUn6ZYZAKoPDCpsxspG8RuKBUbZZGE_AcoUz066Uu7vzTHapUiYfnM5LGhYABHoA', 'Referer': 'https://192.168.148.174:31000/sub-app-unity/syslogManage'}
INFO     root:runcase.py:190 请求参数：{'ruleName': '自动化测试统一平台审计日志规则', 'sendType': '2', 'protocol': 'udp', 'level': '7', 'type': '8', 'charCode': 'GBK', 'timeFormatter': '4', 'logPrefix': '统一平台syslog修改', 'customSeprChar': '++', 'serverInfos': '[{"ip":"192.168.154.77","port":"514"}]', 'syslogFields': '[{"metadataId":1000002,"fieldName":"adminName","indexPrefix":"system_admin_log_audit","platformId":"1","sortNum":1},{"metadataId":1000003,"fieldName":"sourceIp","indexPrefix":"system_admin_log_audit","platformId":"1","sortNum":2}]', 'appCode': 'system_admin_log_audit', 'id': '140'}
INFO     root:runcase.py:252 请求接口结果： {'result': 0, 'resultDesc': '操作成功', 'entityKey': 0}
INFO     root:checkresult.py:152 code断言通过, 期望状态码:200, 实际状态码:200
INFO     root:checkresult.py:87 返回结果断言通过, 期望返回值:{'result': 0, 'resultDesc': '操作成功', 'entityKey': 0}, 实际返回值:{'result': 0, 'resultDesc': '操作成功', 'entityKey': 0}
INFO     root:checkresult.py:58 数据库断言通过, 期望结果:udp, 实际结果:udp
INFO     root:checkresult.py:58 数据库断言通过, 期望结果:统一平台syslog修改, 实际结果:统一平台syslog修改
INFO     root:runcase.py:135 -·-·-·-·-·-·-·-·-·-执行接口 END：修改统一平台审计日志syslog规则-·-·-·-·-·-·-·-·-·-
INFO     root:runcase.py:60 -·-·-·-·-·-·-·-·-·-执行用例 END：修改syslog信息-·-·-·-·-·-·-·-·-·-
INFO     root:test_cases.py:45 ==========执行用例END：updateSyslogRule==========